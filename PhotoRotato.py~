import os
from PIL import Image
from pillow_heif import register_heif_opener

# Register HEIF format
register_heif_opener()

def get_image_info(folder_path):
    image_info = {}
    
    for filename in os.listdir(folder_path):
        file_path = os.path.join(folder_path, filename)
        
        if os.path.isfile(file_path) and filename.lower().endswith(('png', 'jpg', 'jpeg', 'bmp', 'gif', 'tiff', 'heic')):
            with Image.open(file_path) as img:
                width, height = img.size
                orientation = "Portrait" if height > width else "Landscape"
                image_info[file_path] = {"width": width, "height": height, "orientation": orientation}
    
    return image_info

# Example usage
folder_path = "Images"
image_data = get_image_info(folder_path)
for path, info in image_data.items():
    print(f"{path}: {info}")
